<div class="c-segments">
<% if current_user.can_see_one_click_products? %>
  <a href="<%= single_history_orders_path %>">
    <p>通常商品</p>
  </a>
  <div class="border"></div>
  <a href="">
    <p class="is--active">限定公開商品</p>
  </a>
<% else %>
  <p class = "is-active">注文履歴</p>
<% end %>
</div>
<% @details.each do |detail| %>
  <% item = detail.one_click_item %>
  <% payment = detail.one_click_payment %>
  <div class="c-order_title">
    <p class="order_day">注文日:<br><%= detail.completed_on %></p>
    <p class="amount">合計:<br><%= number_to_jpy(detail.paid_total) %></p>
    <p>注文番号:<br><%= "#{payment.number}" %></p>
  </div>
    <div class="c-product_list">
    	<div class="c-product_list__image">
        <%= image_tag item.variant.top_image %>
      </div>
      <div class="c-product__list_detail_wrapper">
    	  <div class="c-product_list__title">
          <%= item.variant.name %>
    	  </div>
    	  <div class="c-product_list__price">
          <%= number_to_jpy(item.variant.price.amount) %>
          (<%=item.quantity%>)
        </div>
      </div>
    </div>
    <div class="p-wrapper--have_padding">
      <% if item.one_click_shipment.try(:shipped?) %>
        <ul class="c-links">
          <a href="#">
            <li class="c-link--small_text--nolink">
              <span>発送を完了しました<br>発送日:<%=item.shipment.shipped_at.to_date%></span>
            </li>
          </a>
        </ul>
      <% elsif payment.canceled? %>
        <ul class="c-links">
          <li class="c-link--nolink">
            この注文はキャンセルされました。
          </li>
        </ul>
      <% elsif item.can_canceled? %>
        <ul class="c-links">
          <%= link_to one_click_cancel_orders_path(payment.number), class: "c-btn--single_click", id: (payment.number+item.variant_id.to_s), data:{ method: "patch" }, :onclick=> "prevent_double_submit_from_link_to(id, event)" do%>
            <li class="c-link">
              商品をキャンセル
            </li>
          <% end %>
        </ul>
      <% else %>
        <ul class="c-links">
          <li class="c-link--nolink">
            ご注文を承りました。配送をお待ち下さい
          </li>
        </ul>
      <% end %>
    </div>
<% end %>
<div class="c-pager"><%= paginate(@details) %></div>
